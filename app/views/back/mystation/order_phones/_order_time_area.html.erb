<% if @order_phone && @order_phone.errors[:order_time].present? %>
  <div class="alert alert-danger"><%= t('view.alert.order.order_time_blank')%></div>
<% end %>

<div>
  <div class="row">
    <div class="col-sm-2">
      <label class="string optional control-label" for="">选择开始日期</label>
    </div>
    <div class="col-sm-2">
      <input car_date_picker="" class="string optional form-control" id="select_start_date" name="select_start_date"
        placeholder="yyyy-mm-dd" type="text" value="">
    </div>
    <!-- 提示图标 -->
    <div class="col-sm-3 col-sm-offset-4">
      <%= render "common/order/order_select_time_tips" %>
    </div>
  </div>

  <div class="row">
    <div id="select_time_info" style="margin-left: 10px;">
      <% if @order_phone && @order_phone.order_time %>
      <span class="label label-success" style="font-size: 100%;">已选择时间段：<%= l(@order_phone.order_time, format: :line) %></span>
      <% end %>
    </div>
  </div>
</div>

<hr>

<div class="car-nav-tabs-custom">
  <div class="tab-content">
    <div class="tab-pane active" style="overflow-x: scroll;">
      <table class="table car-order-select-time-table">
        <thead>
          <th></th>
          <% (10..17).each do |i| %>
            <th><%= "#{i}:00" %></th>
          <% end %>
        </thead>
        <tbody>
          <% @current_order_states.each do |key, value| %>
          <tr>
            <td class="title-date"><%= l(key, format: :short_week)%></td>
            <% value.each_with_index do |c, index| %>
              <% if c > 0 %>
                <td class="data-area">
                  <div class="data" data-toggle="tooltip" data-placement="top" title="<%= '剩余可预约数量:' + c.to_s %>">
                    <% 
                      _value = key.to_time + (index+10).hours
                      _value = l(_value, format: :line)
                    %>
                    <input type="radio" name="order_phone[order_time]" value="<%= _value %>" 
                      <%= 'checked' if @order_phone && @order_phone.order_time && l(@order_phone.order_time, format: :line) == _value %> >
                    <% if c > 2 %>
                      <span class="label label-primary pull-right" style="font-size: 70%; margin-right: 3px;">
                        余:<%= c %>
                      </span>
                    <% else %>
                      <span class="label label-danger pull-right" style="font-size: 70%; margin-right: 3px;">
                        余:<%= c %>
                      </span>
                    <% end %>
                  </div>
                </td>
              <% else %>
                <td class="data-area disabled"></td>
              <% end %>
            <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
